- defaults:
    link:
      relink: true
      relative: true
      force: true

- clean: ['~']

- link:
    ~/.dotfiles:
      path: ''
      force: false
      relink: false
    ~/.astylerc:
    ~/.bash_profile: bash/bash_profile
    ~/.bashrc: bash/bashrc
    ~/.gitconfig:
    ~/.inputrc:
    ~/.liquidpromptrc: bash/liquidpromptrc
    ~/.mdlrc:
    ~/.tmux.conf:
    ~/.vim:
      force: false

- shell:
  -
    command: git submodule update --init --recursive
    description: Installing submodules
  - mkdir -p -m 0700 ~/tmp/vim
  - test -e ~/.bashrc.d && rmdir --ignore-fail-on-non-empty -v ~/.bashrc.d/ || true 
  -
    command: >
      test -e ~/.bashrc.d || (
      git config remote.origin.url | grep -q '^git@' &&
      (git clone $(git config remote.origin.url | sed -e 's/\bdotfiles\b/bashrc.d/') ~/.bashrc.d)
      || mkdir -v ~/.bashrc.d
      )
    description: Setup ~/.bashrc.d
    quiet: true
  -
    command: >
      curl -sSL https://raw.githubusercontent.com/akselsjogren/hedgehog/main/install-hedgehog.bash | bash
      && echo 'export PATH=$PATH:$HOME/.local/hedgehog/bin' > ~/.bashrc.d/90-hedgehog.bash
    description: Install hedgehog
    quiet: true
  -
    command: >
      curl -fLo ~/.vim/autoload/plug.vim --create-dirs
      https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    description: Downloading vim-plug
  - touch ~/.vimrc_local
